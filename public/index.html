<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthVision AI - Gemini 3 Hackathon</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4285f4;
            --secondary: #34a853;
            --danger: #ea4335;
            --warning: #fbbc05;
            --dark: #202124;
            --light: #f8f9fa;
            --gradient: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gradient);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .logo-icon {
            font-size: 48px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s infinite;
        }

        h1 {
            color: var(--dark);
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .tagline {
            color: #5f6368;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .model-badge {
            background: var(--gradient);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3);
        }

        .badge-new {
            background: var(--danger);
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        .hackathon-badge {
            background: linear-gradient(45deg, #FF6B6B, #FFD166);
            color: white;
            padding: 6px 15px;
            border-radius: 15px;
            font-size: 0.8rem;
            display: inline-block;
            margin-bottom: 20px;
        }

        .input-section {
            background: var(--light);
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 25px;
            border: 2px solid #e8f0fe;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
            font-size: 1.1rem;
        }

        label i {
            color: var(--primary);
            margin-right: 10px;
        }

        textarea {
            width: 100%;
            padding: 18px;
            border: 2px solid #dfe1e5;
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            min-height: 120px;
            transition: all 0.3s;
            line-height: 1.5;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.2);
            transform: translateY(-2px);
        }

        .char-count {
            text-align: right;
            font-size: 0.9rem;
            color: #5f6368;
            margin-top: 5px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        button {
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s;
            flex: 1;
            min-width: 180px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .primary-btn {
            background: var(--gradient);
            color: white;
        }

        .primary-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(66, 133, 244, 0.3);
        }

        .secondary-btn {
            background: white;
            color: var(--dark);
            border: 2px solid #dfe1e5;
        }

        .secondary-btn:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        button:active {
            transform: translateY(-1px);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            color: var(--primary);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .result-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-top: 20px;
            border-left: 6px solid var(--primary);
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: var(--gradient);
            opacity: 0.05;
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .severity-low { border-left-color: var(--secondary); }
        .severity-medium { border-left-color: var(--warning); }
        .severity-high { border-left-color: var(--danger); }
        .severity-emergency { border-left-color: #ff0000; }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .result-title {
            font-size: 1.5rem;
            color: var(--dark);
        }

        .severity-badge {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .severity-low .severity-badge { background: #e6f4ea; color: var(--secondary); }
        .severity-medium .severity-badge { background: #fef7e0; color: var(--warning); }
        .severity-high .severity-badge { background: #fce8e6; color: var(--danger); }
        .severity-emergency .severity-badge { background: #ffebee; color: #d32f2f; }

        .result-content {
            margin-bottom: 25px;
        }

        .result-content h3 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-content h3 i {
            color: var(--primary);
        }

        .result-content ul {
            list-style: none;
            padding-left: 0;
        }

        .result-content li {
            padding: 8px 0;
            padding-left: 30px;
            position: relative;
            border-bottom: 1px solid #f0f0f0;
        }

        .result-content li:last-child {
            border-bottom: none;
        }

        .result-content li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: var(--secondary);
            font-weight: bold;
        }

        .result-content p {
            line-height: 1.6;
            color: #5f6368;
        }

        .emergency-alert {
            background: linear-gradient(45deg, #ff0000, #ff6b6b);
            color: white;
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            margin: 25px 0;
            animation: pulse 1.5s infinite;
            box-shadow: 0 8px 25px rgba(255, 0, 0, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .emergency-alert i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            display: block;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 8px 25px rgba(255, 0, 0, 0.3); }
            50% { transform: scale(1.02); box-shadow: 0 12px 30px rgba(255, 0, 0, 0.4); }
            100% { transform: scale(1); box-shadow: 0 8px 25px rgba(255, 0, 0, 0.3); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            border: 2px solid #f0f0f0;
            transition: all 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .feature-card i {
            font-size: 36px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .feature-card h3 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .feature-card p {
            color: #5f6368;
            line-height: 1.5;
        }

        .disclaimer {
            margin-top: 30px;
            padding: 20px;
            background: #fff8e1;
            border-radius: 12px;
            border-left: 4px solid var(--warning);
            font-size: 0.9rem;
            color: #5f6368;
            line-height: 1.6;
        }

        .disclaimer strong {
            color: var(--warning);
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            color: #5f6368;
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }

        .gemini-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #f8f9fa;
            padding: 8px 16px;
            border-radius: 20px;
            margin-top: 10px;
            border: 1px solid #dfe1e5;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 15px;
            }

            .input-section {
                padding: 20px;
            }

            .result-card {
                padding: 20px;
            }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
            line-height: 1.4;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Scroll to top */
        .scroll-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--gradient);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .scroll-top.show {
            opacity: 1;
        }

        /* Example symptoms */
        .example-symptoms {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .example-chip {
            background: #e8f0fe;
            color: var(--primary);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .example-chip:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Success animation */
        @keyframes success {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .success-animation {
            animation: success 0.5s ease;
        }
    </style>
</head>
<body>
    <!-- Scroll to top button -->
    <div class="scroll-top" id="scrollTop" onclick="scrollToTop()">
        <i class="fas fa-chevron-up"></i>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-heartbeat"></i>
                </div>
            </div>

            <h1>HealthVision AI Assistant</h1>
            <div class="tagline">Intelligent Symptom Analysis Powered by AI</div>

            <div class="model-badge">
                <i class="fas fa-microchip"></i> 
                <span>Powered by: <strong>Gemini 2.5 Flash</strong></span>
                <span class="badge-new">Hackathon Ready</span>
            </div>

            <div class="hackathon-badge">
                <i class="fas fa-trophy"></i> Gemini 3 Hackathon Submission
            </div>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="input-group">
                <label for="symptoms">
                    <i class="fas fa-stethoscope"></i> Describe Your Symptoms
                    <span class="tooltip">
                        <i class="fas fa-question-circle" style="color: var(--primary);"></i>
                        <span class="tooltiptext">
                            Be specific: Include duration, severity, location, and any triggers.
                            Example: "Headache for 3 days, throbbing pain on right side, worse with light."
                        </span>
                    </span>
                </label>
                <textarea id="symptoms" rows="5" 
                    placeholder="Example: Sudden dizziness when standing up, occasional blurred vision, lasting about 30 seconds each time..."></textarea>
                <div class="char-count" id="charCount">0/500 characters</div>
            </div>

            <!-- Example Symptoms -->
            <div class="example-symptoms">
                <div class="example-chip" onclick="setExample('headache with light sensitivity and nausea')">Headache with nausea</div>
                <div class="example-chip" onclick="setExample('cough with yellow phlegm and low fever')">Cough with fever</div>
                <div class="example-chip" onclick="setExample('dizziness when standing, blurred vision')">Dizziness</div>
                <div class="example-chip" onclick="setExample('stomach pain after eating, bloating')">Stomach pain</div>
            </div>

            <!-- Buttons -->
            <div class="button-group">
                <button class="primary-btn" onclick="analyzeSymptoms()" id="analyzeBtn">
                    <i class="fas fa-robot"></i> Analyze with Gemini AI
                </button>
                <button class="secondary-btn" onclick="startVoiceInput()">
                    <i class="fas fa-microphone"></i> Voice Input
                </button>
                <button class="secondary-btn" onclick="clearInput()">
                    <i class="fas fa-trash-alt"></i> Clear
                </button>
            </div>
        </div>

        <!-- Loading Indicator -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <div class="loading-text">
                <i class="fas fa-brain"></i> Gemini AI is analyzing your symptoms...
                <div style="font-size: 0.9rem; margin-top: 10px; color: #5f6368;">
                    Using advanced reasoning to provide accurate assessment
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultSection" class="result-section">
            <!-- Emergency Alert -->
            <div class="emergency-alert" id="emergencyAlert" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i>
                <h2>EMERGENCY WARNING</h2>
                <p>Please seek immediate medical attention or call emergency services.</p>
                <p><strong>Do not delay - this could be a serious medical condition.</strong></p>
            </div>

            <!-- Results Card -->
            <div class="result-card" id="resultCard">
                <div class="result-header">
                    <h2 class="result-title">
                        <i class="fas fa-clipboard-check"></i> Analysis Results
                    </h2>
                    <div class="severity-badge" id="severityBadge">Medium</div>
                </div>

                <div class="result-content">
                    <h3><i class="fas fa-diagnoses"></i> Possible Conditions</h3>
                    <ul id="diagnosisList">
                        <!-- Filled by JavaScript -->
                    </ul>
                </div>

                <div class="result-content">
                    <h3><i class="fas fa-first-aid"></i> Immediate Actions</h3>
                    <ul id="actionsList">
                        <!-- Filled by JavaScript -->
                    </ul>
                </div>

                <div class="result-content">
                    <h3><i class="fas fa-home"></i> Home Care Tips</h3>
                    <ul id="careList">
                        <!-- Filled by JavaScript -->
                    </ul>
                </div>

                <div class="result-content">
                    <h3><i class="fas fa-user-md"></i> When to See a Doctor</h3>
                    <p id="doctorAdvice">If symptoms worsen or persist...</p>
                </div>

                <div class="result-content">
                    <h3><i class="fas fa-exclamation-circle"></i> Emergency Signs</h3>
                    <ul id="emergencyList">
                        <!-- Filled by JavaScript -->
                    </ul>
                </div>

                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #f0f0f0;">
                    <p style="color: #5f6368; font-size: 0.9rem;">
                        <i class="fas fa-info-circle" style="color: var(--primary);"></i>
                        Analysis provided by Gemini AI. This is for educational purposes only.
                        <strong>Always consult a healthcare professional for medical advice.</strong>
                    </p>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="button-group" style="margin-top: 20px;">
                <button class="secondary-btn" onclick="shareResults()">
                    <i class="fas fa-share-alt"></i> Share Results
                </button>
                <button class="secondary-btn" onclick="newAnalysis()">
                    <i class="fas fa-plus-circle"></i> New Analysis
                </button>
            </div>
        </div>

        <!-- Features -->
        <div class="feature-grid">
            <div class="feature-card">
                <i class="fas fa-brain"></i>
                <h3>Gemini AI Powered</h3>
                <p>Advanced reasoning for accurate symptom analysis using Google's latest AI models</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-shield-alt"></i>
                <h3>Privacy First</h3>
                <p>Your health data is never stored. All analysis happens in real-time.</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-clock"></i>
                <h3>24/7 Available</h3>
                <p>Get intelligent health guidance anytime, anywhere with instant responses.</p>
            </div>
        </div>

        <!-- Disclaimer -->
        <div class="disclaimer">
            <p><strong><i class="fas fa-exclamation-triangle"></i> Important Medical Disclaimer:</strong> 
            This is an AI-powered educational tool created for the Gemini 3 Hackathon. It is NOT a medical device, 
            diagnostic tool, or substitute for professional medical advice. Always consult with qualified healthcare 
            professionals for medical advice, diagnosis, or treatment. In case of emergency, call your local 
            emergency number immediately.</p>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>HealthVision AI Assistant | Gemini 3 Hackathon Project</p>
            <div class="gemini-badge">
                <i class="fas fa-code"></i> Built with Node.js, Express & Gemini AI API
            </div>
            <p style="margin-top: 15px; font-size: 0.8rem;">
                <i class="fas fa-globe"></i> Live at: <span id="liveUrl">Loading...</span>
            </p>
        </div>
    </div>

    <script>
        const API_URL = window.location.origin;
        let currentSessionId = generateSessionId();

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateCharCount();
            document.getElementById('liveUrl').textContent = window.location.hostname;

            // Show scroll button on scroll
            window.addEventListener('scroll', toggleScrollTop);
        });

        // Generate unique session ID
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // Character count
        function updateCharCount() {
            const textarea = document.getElementById('symptoms');
            const charCount = document.getElementById('charCount');
            const length = textarea.value.length;
            charCount.textContent = `${length}/500 characters`;

            if (length > 450) {
                charCount.style.color = 'var(--danger)';
            } else if (length > 300) {
                charCount.style.color = 'var(--warning)';
            } else {
                charCount.style.color = '#5f6368';
            }
        }

        // Set example symptoms
        function setExample(example) {
            const textarea = document.getElementById('symptoms');
            textarea.value = example;
            textarea.focus();
            updateCharCount();
            textarea.classList.add('success-animation');
            setTimeout(() => textarea.classList.remove('success-animation'), 500);
        }

        // Clear input
        function clearInput() {
            document.getElementById('symptoms').value = '';
            updateCharCount();
            document.getElementById('resultSection').style.display = 'none';
            document.getElementById('symptoms').focus();
        }

        // Analyze symptoms
        async function analyzeSymptoms() {
            const symptoms = document.getElementById('symptoms').value.trim();
            const analyzeBtn = document.getElementById('analyzeBtn');

            if (!symptoms || symptoms.length < 10) {
                alert('Please describe your symptoms in more detail (minimum 10 characters)');
                return;
            }

            if (symptoms.length > 500) {
                alert('Please keep your description under 500 characters');
                return;
            }

            // Show loading, hide results
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultSection').style.display = 'none';
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Analyzing...';

            try {
                const response = await fetch(`${API_URL}/api/analyze-symptoms`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        symptoms: symptoms,
                        sessionId: currentSessionId 
                    })
                });

                const data = await response.json();

                // Hide loading
                document.getElementById('loading').style.display = 'none';
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<i class="fas fa-robot"></i> Analyze with Gemini AI';

                if (data.success) {
                    // Display results
                    displayResults(data);
                } else {
                    throw new Error(data.error || 'Analysis failed');
                }
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<i class="fas fa-robot"></i> Analyze with Gemini AI';

                // Show error but with fallback data if available
                if (error.message.includes('fallback')) {
                    displayResults(error.fallback || {
                        possibleConditions: ["Analysis service temporarily unavailable"],
                        severity: "Medium",
                        immediateActions: ["Please try again shortly"],
                        homeCare: ["Monitor symptoms"],
                        whenToSeeDoctor: "If concerned, consult a doctor",
                        emergencySigns: ["Difficulty breathing", "Chest pain", "Severe pain"],
                        disclaimer: "Service temporarily unavailable. Using fallback data."
                    });
                } else {
                    alert('Error: ' + error.message);
                    console.error('Analysis error:', error);
                }
            }
        }

        // Display results
        function displayResults(data) {
            const resultSection = document.getElementById('resultSection');
            const emergencyAlert = document.getElementById('emergencyAlert');
            const resultCard = document.getElementById('resultCard');
            const severityBadge = document.getElementById('severityBadge');

            // Reset card classes
            resultCard.className = 'result-card';

            // Set severity
            const severity = data.severity || data.severityLevel || 'Medium';
            const severityClass = 'severity-' + severity.toLowerCase();
            resultCard.classList.add(severityClass);
            severityBadge.textContent = severity;

            // Show/hide emergency alert
            if (severity.toLowerCase() === 'emergency' || data.emergency || data.requiresImmediateAttention) {
                emergencyAlert.style.display = 'block';
                resultCard.classList.add('severity-emergency');
            } else {
                emergencyAlert.style.display = 'none';
            }

            // Populate diagnosis
            const diagnosisList = document.getElementById('diagnosisList');
            diagnosisList.innerHTML = '';
            const conditions = data.possibleConditions || data.possibleCauses || data.diagnosis || ["Multiple potential factors"];
            conditions.forEach(condition => {
                const li = document.createElement('li');
                li.textContent = condition;
                diagnosisList.appendChild(li);
            });

            // Populate immediate actions
            const actionsList = document.getElementById('actionsList');
            actionsList.innerHTML = '';
            const actions = data.immediateActions || data.recommendations || ["Rest and monitor"];
            actions.forEach(action => {
                const li = document.createElement('li');
                li.textContent = action;
                actionsList.appendChild(li);
            });

            // Populate home care
            const careList = document.getElementById('careList');
            careList.innerHTML = '';
            const careTips = data.homeCare || data.homeCareTips || data.homeRemedies || ["Stay hydrated", "Get adequate rest"];
            careTips.forEach(tip => {
                const li = document.createElement('li');
                li.textContent = tip;
                careList.appendChild(li);
            });

            // Doctor advice
            document.getElementById('doctorAdvice').textContent = 
                data.whenToSeeDoctor || data.whenToSeekHelp || "If symptoms persist or worsen";

            // Emergency signs
            const emergencyList = document.getElementById('emergencyList');
            emergencyList.innerHTML = '';
            const emergencies = data.emergencySigns || data.redFlags || 
                ["Difficulty breathing", "Chest pain", "Severe headache", "Loss of consciousness"];
            emergencies.forEach(sign => {
                const li = document.createElement('li');
                li.textContent = sign;
                emergencyList.appendChild(li);
            });

            // Show results
            resultSection.style.display = 'block';

            // Smooth scroll to results
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

            // Add success animation
            resultCard.classList.add('success-animation');
            setTimeout(() => resultCard.classList.remove('success-animation'), 1000);
        }

        // Voice input
        function startVoiceInput() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                const recognition = new SpeechRecognition();

                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';

                recognition.onstart = function() {
                    document.getElementById('symptoms').placeholder = "ðŸŽ¤ Listening... Speak now...";
                };

                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('symptoms').value = transcript;
                    document.getElementById('symptoms').placeholder = "Describe your symptoms...";
                    updateCharCount();
                };

                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                    document.getElementById('symptoms').placeholder = "Describe your symptoms...";
                    alert('Voice input failed. Please type your symptoms instead.');
                };

                recognition.onend = function() {
                    document.getElementById('symptoms').placeholder = "Describe your symptoms...";
                };

                recognition.start();
            } else {
                alert('Voice input is not supported in your browser. Please use Chrome or Edge.');
            }
        }

        // Share results
        function shareResults() {
            const symptoms = document.getElementById('symptoms').value.substring(0, 100);
            const severity = document.getElementById('severityBadge').textContent;

            const shareText = `HealthVision AI Analysis\nSymptoms: ${symptoms}...\nSeverity: ${severity}\n\n${window.location.href}`;

            if (navigator.share) {
                navigator.share({
                    title: 'HealthVision AI Results',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('Results copied to clipboard!');
                });
            }
        }

        // New analysis
        function newAnalysis() {
            clearInput();
            currentSessionId = generateSessionId();
            document.getElementById('symptoms').focus();
        }

        // Scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleScrollTop() {
            const scrollTopBtn = document.getElementById('scrollTop');
            if (window.scrollY > 300) {
                scrollTopBtn.classList.add('show');
            } else {
                scrollTopBtn.classList.remove('show');
            }
        }

        // Event listeners
        document.getElementById('symptoms').addEventListener('input', updateCharCount);

        // Enter key to submit (Ctrl+Enter)
        document.getElementById('symptoms').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                analyzeSymptoms();
            }
        });
    </script>
</body>
</html>
